<html>
    <head>
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
        
    </head>
    <body >
        <a-scene    initialisation 
                    embedded                    
                    arjs=' detectionMode: mono_and_matrix; 
                           matrixCodeType: 3x3;
                           sourceType: webcam; 
                           sourceWidth:1280; 
                           sourceHeight:960; 
                           displayWidth: 1280; 
                           displayHeight: 960;
                           ' 
                    renderer='precision: medium; antialias:true'
        >
            <a-marker type="barcode" value='7' >
                <a-entity id="cristal" scale='0.2 0.2 0.2'>
                    <!-- rempli lors de l'initialisation-->
                </a-entity>                           
            </a-marker>  
            
            <a-entity camera></a-entity>  
        
        </a-scene>  
        
    </body>
    <script>
        var parameters = {
            // type of source - ['webcam', 'image', 'video']
            sourceType: "webcam",
            // url of the source - valid if sourceType = image|video
            sourceUrl: null,
            // resolution of at which we initialize the source image
            sourceWidth: 640,
            sourceHeight: 480,
            // resolution displayed for the source
            displayWidth: 640,
            displayHeight: 480
        };
        
        AFRAME.registerComponent('initialisation', {
            init: function () {
                var sceneEl = document.querySelector('#cristal');
                var x;
                var y;
                var z;
                var xMax = 2;
                var yMax = 5;
                var zMax = 2;
                var xMin = -2;
                var yMin = 0;
                var zMin = -2;

               for(x=xMin ; x < xMax ; x++){
                    for(y=yMin ; y < yMax ; y++){
                        for(z=zMin ; z < zMax ; z++){                            
                            addCellule(x,y,z,sceneEl);
                        }
                    }
               }
                
                      
                
            }
        });

        function addCellule(x,y,z, scene){
            scene.appendChild(addAtome(x,y,z,'green'));
            scene.appendChild(addAtome(x+0.5,y+0.5,z,'gray'));
            scene.appendChild(addAtome(x+0.5,y,z+0.5,'gray'));
            scene.appendChild(addAtome(x,y+0.5,z+0.5,'gray'));
        }



        function addAtome(x,y,z,c){
            var atome = document.createElement('a-sphere');
            atome.setAttribute('position', x+' '+y+' '+z);
            atome.setAttribute('radius', '0.354');
            atome.setAttribute('color', c);                    
            return atome
        }

    </script>
</html>